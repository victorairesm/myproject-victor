<!DOCTYPE html>
<!--
To change this license header, choose License Headers in Project Properties.
To change this template file, choose Tools | Templates
and open the template in the editor.
-->
<html>
    <head>

    </head>
    <body>
        <canvas id = "canvas1" width = "600" height = "600" style = "border:solid" tabindex="0">

        </canvas>
        <div style="border:solid;background-color: red;
             color:white;">
            <span>Pontos:</span>
            <input type="text" id="txtpontos"/><br/>
            <span>Vidas:</span>
            <input type="text" id="txtvidas"/><br/>
        </div> 
        <form>

            <input type="button" value="esquerda" onclick="mover('E');"/>
            <input type="button" value="direita" onclick="mover('D');"/>
            <input type="button" value="cima" onclick="mover('C');"/>
            <input type="button" value="baixo" onclick="mover('B');"/>
        </form>
        <script language="javascript">
            var ctx1 = document.getElementById('canvas1').getContext("2d");
            var x, y, largura, altura, intervalo, velocidade;
            var comidax, comiday, comidaaltura, comidalargura, pontos, vidas;
            x = 5;
            y = 5;
            largura = 50;
            altura = 50;
            velocidade = 30;
            passo = 5;

            comidax = 100;
            comiday = 100;
            comidalargura = 10;
            comidaaltura = 10;

            function inicia() {
                document.getElementById('canvas1').focus();
                pontos = 0;
                vidas = 5;
                txtpontos.value = pontos;
                txtvidas.value = vidas;

                x = 5;
                y = 5;
                largura = 50;
                altura = 50;
                velocidade = 30;
                passo = 5;

                comidax = 100;
                comiday = 100;
                comidalargura = 10;
                comidaaltura = 10;
                
                ctx1.clearRect(0, 0, 600, 600);
                desenha();
                desenhacomida();
            }
            document.addEventListener("DOMContentLoaded", iniciaeventos, false);
            function iniciaeventos()
            {
                document.getElementById('canvas1').addEventListener("keydown", tec, false);
            }
            function tec(e)
            {
                if (e.keyCode == "37") {

                    mover('E');

                } else
                if (e.keyCode == "38") {

                    mover('C');

                } else
                if (e.keyCode == "39") {

                    mover('D');

                } else
                if (e.keyCode == "40") {

                    mover('B');

                }
            }
            function LimparTela() {

                ctx1.clearRect(x, y, altura, largura);
            }
            function mover(direcao) {
                clearInterval(intervalo);
                switch (direcao) {
                    case 'D':
                        intervalo = setInterval(moverDireita, velocidade);
                        break;
                    case 'E':
                        intervalo = setInterval(moverEsquerda, velocidade);
                        break;
                    case 'C':
                        intervalo = setInterval(moverCima, velocidade);
                        break;
                    case 'B':
                        intervalo = setInterval(moverBaixo, velocidade);
                        break;
                }
            }
            function moverEsquerda() {
                if (x > 0) {
                    LimparTela();
                    x = x - passo;
                    verificacomida();
                    desenha();

                } else {
                    perdeVida();
                }

            }
            function moverDireita() {

                if (x < (600 - largura)) {
                    LimparTela();
                    x = x + passo;
                    verificacomida();
                    desenha();

                } else {
                    perdeVida();
                }
            }
            function moverCima() {
                if (y > 0) {
                    LimparTela();
                    y = y - passo;
                    verificacomida();
                    desenha();

                } else {
                    perdeVida();
                }
            }
            function moverBaixo() {
                if (y < (600 - altura)) {
                    LimparTela();
                    y = y + passo;
                    verificacomida();
                    desenha();
                } else {
                    perdeVida();
                }
            }
            function desenha() {
                ctx1.fillStyle = "black";
                ctx1.fillRect(x, y, largura, altura);
            }
            function desenhacomida() {
                ctx1.fillStyle = "green";
                ctx1.fillRect(comidax, comiday, comidalargura, comidaaltura);
            }
            function ganhaPonto() {
                pontos = pontos + 1;
                txtpontos.value = pontos;
                if (pontos % 5 == 0) {
                    velocidade = velocidade - 20;
                }
            }
            function perdeVida() {
                vidas = vidas - 1;
                txtvidas.value = vidas;
                clearInterval(intervalo);
                if (vidas == 0) {
                    alert("GAME OVER");
                    inicia();
                }
            }
            function verificacomida() {
                if ((comidax + (comidalargura / 2)) >= x &&
                        (comidax + (comidalargura / 2)) <= (largura + x)
                        && (comiday + (comidaaltura / 2)) >= y &&
                        (comiday + (comidaaltura / 2)) <= (altura + y))
                {
                    ganhaPonto();
                    comidax = Math.floor((Math.random() * (600 - comidalargura)));
                    comiday = Math.floor((Math.random() * (600 - comidaaltura)));

                    desenhacomida();
                }
            }

            inicia();

        </script>
    </body>
</html>